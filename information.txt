# تفاصيل دقيقة لنظام إدارة العيادة

هذا المستند يوفر شرحاً مفصلاً للتطبيق، ميزاته، أنواع البيانات المستخدمة، وأنواع المستخدمين وصلاحياتهم.

---

## 1. نظرة عامة على التطبيق

**اسم التطبيق:** نظام إدارة العيادة (Sara dental clinic)

**الوصف:**
هو تطبيق ويب شامل مصمم لإدارة عمليات العيادات الطبية بفعالية. يتيح النظام إدارة ملفات المرضى، المواعيد، خطط العلاج، المدفوعات، والمستخدمين (مدير، طبيب، سكرتير، مدير فرعي).
يتميز التطبيق بتصميم عصري ومتجاوب (Mobile-First)، ويدعم العمل دون اتصال بالإنترنت مع مزامنة البيانات تلقائياً عند عودة الاتصال، كما أنه قابل للتثبيت على الأجهزة (PWA).

---

## 2. أنواع المستخدمين وصلاحياتهم

يحتوي النظام على أربعة أنواع من المستخدمين، لكل منهم صلاحيات محددة:

### أ. مدير (Admin)
- يمتلك كافة الصلاحيات في النظام.
- **الوصول:** لوحة التحكم، المستخدمين، المرضى، المواعيد، المدفوعات، الإحصائيات، الملف الشخصي، الدعم.

### ب. مدير فرعي (Sub-Manager)
- يمتلك صلاحيات مشابهة للمدير.
- **الوصول:** لوحة التحكم، المستخدمين، المرضى، المواعيد، المدفوعات، الإحصائيات، الملف الشخصي، الدعم.

### ج. طبيب (Doctor)
- يركز على الجوانب الطبية للمرضى المرتبطين به.
- **الوصول:** لوحة التحكم، مرضاي (قائمة المرضى الخاصة به فقط)، الملف الشخصي (لإدارة جدول عمله)، الدعم.

### د. سكرتير (Secretary)
- مسؤول عن المهام الإدارية والتنظيمية.
- **الوصول:** لوحة التحكم، المرضى، المدفوعات، الملف الشخصي، الدعم.

---

## 3. ميزات التطبيق الرئيسية

- **إدارة المستخدمين:** إضافة، تعديل، وحذف الأطباء، السكرتارية، والمدراء.
- **إدارة المرضى:**
    - إنشاء ملفات كاملة للمرضى بمعلومات طبية وشخصية.
    - بحث متقدم وفلترة للمرضى (حسب الاسم، الكود، الهاتف، الطبيب، حالة اكتمال العلاج أو الدفع).
    - عرض تفصيلي لكل مريض.
- **إدارة الجلسات وخطط العلاج:**
    - إنشاء جلسات علاجية لكل مريض وربطها بطبيب.
    - إضافة علاجات محددة لكل جلسة مع تحديد السعر، الملاحظات، وتاريخ التنفيذ.
    - وضع خطط علاجية مستقبلية للمرضى.
- **إدارة المواعيد:**
    - نظام متكامل لحجز المواعيد للمرضى مع أطباء محددين.
    - عرض المواعيد حسب اليوم، الأسبوع، الشهر، أو المواعيد المنتهية.
    - عرض الأوقات المتاحة لكل طبيب في يوم محدد.
- **الإدارة المالية:**
    - تسجيل المدفوعات من المرضى.
    - عرض ملخص مالي لكل مريض (إجمالي التكاليف، إجمالي المدفوعات، الرصيد المتبقي).
- **إدارة إعدادات العلاج:** إضافة وتعديل أنواع العلاجات المتوفرة في العيادة وأسعارها الأساسية.
- **إحصائيات وتقارير:**
    - لوحة تحكم تعرض إحصائيات سريعة (عدد الأطباء، المرضى، مواعيد اليوم).
    - صفحة إحصائيات متقدمة مع فلترة حسب التواريخ لعرض إجمالي التكاليف والإيرادات.
    - إمكانية طباعة تقرير شامل لكل مريض (مع أو بدون الملخص المالي).
- **إدارة جدول الأطباء:** يمكن للأطباء تحديد أيام وساعات عملهم.
- **معرض صور المرضى:** رفع صور خاصة بكل مريض (مثل صور الأشعة) مع تعليقات وتواريخ.
- **سجل النشاط:** تتبع جميع الإجراءات التي تتم على ملفات المرضى (إنشاء، تعديل، حذف) مع عرض المستخدم الذي قام بالإجراء وتوقيته.
- **دعم العمل دون اتصال (Offline Support):** يمكن للمستخدمين أداء معظم المهام دون اتصال بالإنترنت، ويتم مزامنة البيانات تلقائياً عند عودة الاتصال.
- **تطبيق ويب تقدمي (PWA):** يمكن تثبيت التطبيق على سطح المكتب أو شاشة الهاتف الرئيسية للوصول السريع.
- **دعم الوضع المظلم (Dark Mode):** واجهة مريحة للعين في ظروف الإضاءة المنخفضة.

---

## 4. أنواع البيانات وحقولها (Data Types & Fields)

### أ. المستخدم (User)
- `id` (string): المعرف الفريد.
- `name` (string): الاسم الكامل (الاسم).
- `email` (string): البريد الإلكتروني.
- `password` (string): كلمة المرور (عند الإنشاء أو التعديل).
- `role` (UserRole): نوع المستخدم (مدير، طبيب، سكرتير...).
- `specialty` (string, optional): تخصص الطبيب.
- `is_diagnosis_doctor` (boolean, optional): هل هو طبيب تشخيص (يملك صلاحيات إضافية).

### ب. المريض (Patient)
- `id` (string): المعرف الفريد.
- `code` (string): كود المريض.
- `name` (string): الاسم الكامل (الاسم).
- `age` (number): العمر.
- `phone` (string): رقم الهاتف.
- `notes` (string, optional): ملاحظات عامة.
- `doctorIds` (string[]): قائمة بمعرفات الأطباء المسؤولين.
- `gender` (Gender): الجنس (ذكر/أنثى).
- `isSmoker` (boolean, optional): هل المريض مدخن.
- `isPregnant` (boolean, optional): هل المريضة حامل.
- `drugAllergy` (string, optional): الحساسية الدوائية.
- `chronicDiseases` (string, optional): الأمراض المزمنة.
- `createdAt` (string): تاريخ إنشاء الملف.
- `completed` (boolean, optional): حالة اكتمال خطة العلاج.
- `payment_completed` (boolean, optional): حالة اكتمال الدفع.

### ج. الجلسة (Session)
- `id` (string): المعرف الفريد.
- `patientId` (string): معرف المريض.
- `doctorId` (string): معرف الطبيب المسؤول عن الجلسة.
- `title` (string): عنوان الجلسة.
- `date` (string): تاريخ الجلسة.
- `notes` (string): ملاحظات الجلسة.
- `treatments` (SessionTreatment[]): قائمة العلاجات ضمن الجلسة.
- `completed` (boolean, optional): هل اكتملت جميع علاجات الجلسة.

### د. العلاج الأساسي (Treatment - إعدادات)
- `id` (string): المعرف الفريد.
- `name` (string): اسم العلاج.
- `price` (number): السعر الأساسي.
- `notes` (string, optional): ملاحظات.

### هـ. علاج ضمن جلسة (SessionTreatment)
- `instanceId` (string): المعرف الفريد لهذا العلاج المحدد في هذه الجلسة.
- `sessionId` (string): معرف الجلسة.
- `sessionPrice` (number): سعر العلاج المحدد لهذه الجلسة (قد يختلف عن السعر الأساسي).
- `sessionNotes` (string, optional): ملاحظات خاصة بهذا العلاج في الجلسة.
- `completed` (boolean): هل تم تنفيذ العلاج.
- `treatmentDate` (string, optional): التاريخ الفعلي لتنفيذ العلاج.
- `additionalCosts` (number, optional): تكاليف إضافية.
- (يرث الحقول الأخرى من العلاج الأساسي مثل `id`, `name`, `price`).

### و. الموعد (Appointment)
- `id` (string): المعرف الفريد.
- `patientId` (string): معرف المريض.
- `doctorId` (string): معرف الطبيب.
- `date` (string): تاريخ الموعد (YYYY-MM-DD).
- `time` (string): وقت الموعد (HH:MM).
- `notes` (string, optional): ملاحظات.
- `createdBy` (string, optional): معرف المستخدم الذي أنشأ الموعد.

### ز. الدفعة المالية (Payment)
- `id` (string): المعرف الفريد.
- `patientId` (string): معرف المريض.
- `amount` (number): المبلغ المدفوع.
- `date` (string): تاريخ الدفعة (YYYY-MM-DD).

### ح. صورة مريض (PatientPhoto)
- `id` (string): المعرف الفريد.
- `patientId` (string): معرف المريض.
- `imageUrl` (string): رابط الصورة (أو بيانات base64).
- `caption` (string): تعليق على الصورة.
- `date` (string): تاريخ التقاط الصورة (YYYY-MM-DD).

### ط. جدول عمل الطبيب (DaySchedule)
- `id` (string, optional): المعرف الفريد للجدول في قاعدة البيانات.
- `day` (number): يوم الأسبوع (0 للأحد، 1 للاثنين...).
- `isWorkDay` (boolean): هل هو يوم عمل.
- `startTime` (string): وقت بدء الدوام (HH:MM).
- `endTime` (string): وقت انتهاء الدوام (HH:MM).
- `doctorId` (string): معرف الطبيب.

### ي. سجل النشاط (ActivityLog)
- `id` (string): المعرف الفريد.
- `patientId` (string): معرف المريض المتعلق بالنشاط.
- `userId` (string): معرف المستخدم الذي قام بالإجراء.
- `userName` (string): اسم المستخدم الذي قام بالإجراء.
- `actionType` (ActivityLogActionType): نوع الإجراء (إنشاء، تحديث، حذف).
- `description` (string): وصف الإجراء.
- `timestamp` (string): تاريخ ووقت الإجراء.
